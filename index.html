<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bilan Carbone Stage</title>
    <link rel="stylesheet" href="outilstage.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container">
        

       
           
             <!-- Globe ajout√© ici -->
        
        
        <!-- Titre principal -->
        <h1>Bilan Carbone Stage</h1>
        <h4>
            Ce simulateur √©value l'empreinte carbone de votre stage, c'est-√†-dire les √©missions li√©es 
            au transport vers le lieu de stage ainsi que celles li√©es √† vos d√©placements domicile lieu de stage.
        </h4>
       
        
        <!-- Section formulaire -->
        <div id="form-section">
            <form id="carbonForm">
                
                <div class="logo-container">
                    <img src="eseo.png" alt="Logo ESEO" class="logo">
                    <span class="globe">üåç</span>
                </div>
                
                <p>Les autres √©missions li√©es √† l'alimentation ou encore √† l'√©lectricit√© sont hors p√©rim√®tre.</p>
                  
                
                <!-- Identit√© -->
                <input type="text" id="Nom" name="Nom" required placeholder="Entrez votre nom">
                <input type="text" id="Pr√©nom" name="Pr√©nom" required placeholder="Entrez votre pr√©nom">

                <hr>

                <!-- Choix du site -->
                <label for="site">Choix du campus d'origine :</label>
                <select id="site" name="site">
                    <option value="Angers">Angers</option>
                    <option value="Paris-V√©lizy">Paris-V√©lizy</option>
                    <option value="Dijon">Dijon</option>
                </select>
                
                <!-- Classe -->
                <label for="classe">Choisissez votre classe :</label>
                <select id="classe" name="classe">
                    <option value="E1">E1</option>
                    <option value="E2">E2</option>
                    <option value="E3e">E3e</option>
                    <option value="E4e">E4e</option>
                    <option value="E5e">E5e</option>
                    <option value="E3a">E3a</option>
                    <option value="E4a">E4a</option>
                    <option value="E5a">E5a</option>
                    <option value="B1">B1</option>
                    <option value="B2">B2</option>
                    <option value="B3">B3</option>
                </select>

                <h3>Dans un premier temps, int√©ressons-nous √† la fa√ßon dont vous vous √™tes rendus sur le lieu du stage</h3>

                <p> Si vous avez effectu√© un covoiturage , veuillez s√©lectionner dans "mode de transport" le v√©hicule consid√©r√© avant de s√©lectionner "oui" dans la rubrique covoiturage</p>


                <!-- Mode de transport principal -->
                <label for="Mode1">Quel est le mode de transport principal utilis√© pour vous rendre sur le lieu du stage:</label>
                <select id="Mode1" name="Mode1">
                    <option value="train">Train</option>
                    <option value="autocar">Autocar</option>
                    <option value="AvionCourt">Avion court-courrier (France)</option>
                    <option value="AvionMoyen">Avion moyen-courrier (Europe)</option>
                    <option value="AvionLong">Avion long-courrier (hors Europe)</option>
                    <option value="VoitureDiesel">Voiture Diesel</option>
                    <option value="VoitureEssence">Voiture Essence</option>
                    <option value="voitureElec">Voiture √©lectrique</option>
                    <option value="voilier">Voilier</option>
                    <option value="marche">Marche</option>
                    <option value="velo">V√©lo</option>
                    

                </select>

                
                <!-- Distance aller -->
                <label for="distance1">Distance aller pour vous rendre sur le lieu  du stage  :</label>
                <input type="number" id="distance1" name="distance1" required min="0" placeholder="Entrez la distance en km">

                <!-- Covoiturage pour le premier mode de transport -->
<label for="covoiturage1">Avez-vous fait du covoiturage pour le mode de transport principal ?</label>
<select id="covoiturage1" name="covoiturage1" onchange="toggleCovoituragePassengers(1)">
    <option value="non">Non</option>
    <option value="oui">Oui</option>
</select>

<div id="passagersContainer1" style="display: none;">
    <label for="passagers1">Nombre total de passagers (y compris vous) :</label>
    <input type="number" id="passagers1" name="passagers1" min="1" placeholder="Entrez le nombre de passagers">
</div>

<hr>
                <label for="mode2">Mode de transport secondaire si existant :</label>
                <select id="mode2" name="mode2">
                    <option value=" "></option>
                    <option value="train">Train</option>
                    <option value="autocar">Autocar</option>
                    <option value="AvionCourt">Avion court-courrier (France)</option>
                    <option value="AvionMoyen">Avion moyen-courrier (Europe)</option>
                    <option value="AvionLong">Avion long-courrier (hors Europe)</option>
                    <option value="VoitureDiesel">Voiture Diesel</option>
                    <option value="VoitureEssence">Voiture Essence</option>
                    <option value="voitureElec">Voiture √©lectrique</option>
                    <option value="voilier">Voilier</option>
                    <option value="marche">Marche</option>
                    <option value="velo">V√©lo</option>
                    

                </select>

                <label for="distance2">Distance parcourue :</label>
                <input type="number" id="distance2" name="distance2" required min="0" placeholder="Entrez la distance en km">

                <!-- Covoiturage pour le deuxi√®me mode de transport -->
<label for="covoiturage2">Avez-vous fait du covoiturage pour ce 2e mode de transport secondaire ?</label>
<select id="covoiturage2" name="covoiturage2" onchange="toggleCovoituragePassengers(2)">
    <option value="non">Non</option>
    <option value="oui">Oui</option>
</select>

<div id="passagersContainer2" style="display: none;">
    <label for="passagers2">Nombre total de passagers (y compris vous) :</label>
    <input type="number" id="passagers2" name="passagers2" min="1" placeholder="Entrez le nombre de passagers">
</div>

                <h3>Ensuite, voyons comment vous vous d√©placiez de votre domicile √† votre lieu de travail</h3>

                <!-- Transport principal -->
                <label for="transport">Quel est le mode de transport principal ?</label>
                <select id="transport" name="transport" required>
                    
                    <option value="VoitureDiesel">Voiture Diesel</option>
                    <option value="VoitureEssence">Voiture Essence</option>
                    <option value="tram">Tramway</option>
                    <option value="autobus">Autobus</option>
                    <option value="trotinetteElec">Trottinette √âlectrique</option>
                    <option value="marche">Marche √† pied</option>
                    <option value="velo">V√©lo</option>
                    <option value="metro">M√©tro</option>
                </select>
               



               

                 <!-- Distance domicile-lieu -->
                 <label for="distance">Distance domicile-lieu de stage (km) :</label>
                 <input type="number" id="distance" name="distance" required min="0" placeholder="Entrez la distance allez uniquement en km">

                 <label for="covoiturage3">Avez-vous fait du covoiturage  ?</label>
                 <select id="covoiturage3" name="covoiturage3" onchange="toggleCovoituragePassengers(3)">
                     <option value="non">Non</option>
                     <option value="oui">Oui</option>
                 </select>

                 <div id="passagersContainer3" style="display: none;">
                    <label for="passagers3">Nombre total de passagers (y compris vous) :</label>
                    <input type="number" id="passagers3" name="passagers3" min="1" placeholder="Entrez le nombre de passagers">
                </div>
                <!-- Jours et dur√©e -->
                <label for="Jours">Nombre moyen de jours de travail par semaine :</label>
                <input type="number" id="Jours" name="Jours" required min="0" placeholder="Entrez le nombre de jours">
                
                <label for="Duree">Dur√©e totale du stage (semaines) :</label>
                <input type="number" id="Duree" name="Duree" required min="0" placeholder="Entrez le nombre de semaines">

                <hr>
                <!-- Bouton calculer -->
                <button type="button" class="btn" onclick="calculateCarbon()">Calculer</button>
                <button type="button" id="rafraichir" class="btn" onclick="location.reload();">R√©initialiser</button>
            </form>
        </div>

        <!-- Section r√©sultat -->
        <div id="result-section">
            <h2>R√©sultat</h2>
            <div id="result"></div>
            <canvas id="carbonChart" width="400" height="200"></canvas>
            <button id="back-button" class="btn" type="button" onclick="goBack()">Revenir au formulaire</button>
           
            <button class="btn" type="button" onclick="exportToExcel()">T√©l√©charger le fichier Excel</button>
           

          <footer>

            <h5>Les √©missions sont calcul√©es sur une simulation de trajets aller-retour</h5>
          </footer>  
        </div>
        <div>
            <canvas id="carbonChart"></canvas>
            
        </div>

        
        

    <script src="outilstagiaire.js"></script>
</body>
</html>
